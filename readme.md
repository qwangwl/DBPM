This is a draft version of the code, including additional experiments such as parameter analysis.